
services:

  chromadb:
    image: chromadb/chroma:1.0.16.dev59   
    container_name: chromadb
    ports:
      - "8000:8000"
    volumes:
      - ./chroma_persist:/data        
    command: >
      chromadb start
        --persist_directory /data
        --port 8000
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/healthz"]
      interval: 10s
      timeout: 5s
      retries: 5

  ollama:
    image: ghcr.io/ollama/ollama:latest
    container_name: ollama
    command: ["serve", "--port", "11434"]
    ports:
      - "11434:11434"
    healthcheck:
      test: ["CMD-SHELL", "curl -fs http://localhost:11434/v1/models || exit 1"]
      interval: 10s
      timeout: 5s
      retries: 5
